<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		
        <title>Getting started with Metadata Editor</title>
		<!--External dependencies-->
		<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ajv/8.11.0/ajv2019.min.js" integrity="sha512-2eKme1Qc3D1JArscd5NVLW4niVDRuutDBHJmPhAoJNc8ZMD8Ynb0dow4fItVzEPb8EF9CCzT9hFyB85I6HJAjA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" integrity="sha512-7fNh7OUGa7bdpmSQ81iNxgBywspNTxVxBxfbT1gSnQ124VGfksj3AR/QGhdYaO8ZLHBLSoaa+VsVDgw795eBaw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<!--Metadata Editor library-->
		<script type="text/javascript" src="../../deps/jsonform/jsonform.js"></script>
		<script type="text/javascript" src="../../lib/js/metadataeditor.js"></script>
        <!--Input data-->
		<script type="text/javascript" src="./schema.js"></script>
		<script type="text/javascript" src="./ui-schema.js"></script>
		<script type="text/javascript" src="./data.js"></script>
		<!--Basic stylesheet-->
        <link rel="stylesheet" href="../../lib/css/metadataeditor.style.basic.css" />
	</head>
	
    <body>
		<div class="container">
            <div class="col-12">
                <div class="boxlist margin-top-30" id="training-box">
                    <div class="box-header bg-green-blue">
                        <h3 class="box-title">Simple Form Examples</h3>
					</div>
					<div class="panel-group" id="accordion">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">
									<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
										<span id="oneSpan" class="glyphicon glyphicon-menu-right text-success"></span> The First Form            
									</a>
								</h4>
							</div>
							<div id="collapseOne" class="panel-collapse collapse in">
								<div class="panel-body">
									<p>In this first example, we automatically generate a form from a simple JSON schema. The schema is read from <i><b>schema.js</b></i>, which directly assigns the schema to a variable called <i><b>dataModel</b></i>, that is used as input for the Metadata Editor Form. In addition, the form type is provided, which is in our case <i><b>CREATE</b></i>, which means we start with an empty form where all fields are editable. Thus, the parameter object looks as follows:
									</p>
<pre>
var options = {
	operation: "CREATE",
	dataModel: this.dataModel
};</pre>
									Using these parameters, we can now insert the form into the page. It takes the <i><b>options</b></i> object for parameterization and renders where the <i><b>&lt;form id="plain"&gt;&lt;/form&gt;</b></i> tags are located in this HTML file:
<pre>
$('form_plain').metadataeditorForm(options, (value) => {
	var resource = value;
	JSON.parse(JSON.stringify(resource));
	Console.log(resource);
});</pre>
								Furthermore, the form received a callback function, which prints the resulting object at the console as soon as <i><b>CREATE</b></i> is clicked.</p>
								<hr/>
								<div class="box-body"> 
									<form id="plain"></form>
								</div>		
							</div>
						</div>
					</div>
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
									<span id="twoSpan" class="glyphicon glyphicon-menu-right text-info"></span> A More Appealing Form            
								</a>
							</h4>
						</div>
						<div id="collapseTwo" class="panel-collapse collapse">
							<div class="panel-body">
								<p>Now, it's time to work on a more user-friendly representation of the form. There are two things we are doing: 
									<ul>
										<li>Apply a UI Schema</li>
										<li>Overwrite the default submit button label</li>
									</ul>
									The UI Schema we include from the file <i><b>schema.js</b></i>, which assigns the schema to a variable called <i><b>uiSchema</b></i>. The resulting <i><b>options</b></i> object now looks as follows:
<pre>
var options = {
	operation: "CREATE",
	dataModel: this.dataModel
	uiForm: this.uiSchema,
	buttonTitle: "Submit"
};</pre>
									In addition to providing the <i><b>uiForm</b></i> property you also see, that we provide <i><b>buttonTitle</b></i> which overwrites the default label of the submit button. Having this done, the form is rendered where the <i><b>&lt;form id="with-schema&gt;&lt;/form&gt;</b></i> tags are located using the following JavaScript call:
<pre>
$('form_ui_schema').metadataeditorForm(options, (value) => {
	var resource = value;
	JSON.parse(JSON.stringify(resource));
	Console.debug(resource);
});</pre>
								</p>
								<hr/>	
								<div class="box-body"> 
									<form id="with-schema"></form>
								</div>
							</div>
						</div>
					</div>
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
									<span id="threeSpan" class="glyphicon glyphicon-menu-right text-info"></span> A Form with Data            
									</a>
							</h4>
						</div>
						<div id="collapseThree" class="panel-collapse collapse">
							<div class="panel-body">
								<p>Finally, we will learn how to add some data to show in the form. Therefore, we have a file <i><b>data.js</b></i> which contains a variable <i><b>resource</b></i> defining the input of our form. Furthermore, we have to change the options for parameterizing our form as follows:
<pre>
var options = {
	operation: "READ",
	dataModel: this.dataModel,
	uiForm: this.uiSchema,
	resource: this.resource,
	buttonTitle: "Update"
};</pre>
									As you can see, we changed to operation to <i><b>READ</b></i>, as operation <i><b>CREATE</b></i> does not accept any inputs. This input is provided by property <i><b>resource</b></i> pointing to <i><b>this.resource</b></i> which comes from <i><b>data.js</b></i>.
									The result is rendered where the <i><b>&lt;form id="with-data"&gt;&lt;/form&gt;</b></i> tags are located using the following JavaScript call:
<pre>
$('#with-data').metadataeditorForm(options, () => {});</pre>
								</p>
								For <i><b>READ</b></i> forms no callbacks are supported as they are purely for visualization. Thus, the callback function remains empty in this example.
								<hr/>	
								<div class="box-body"> 
									<form id="with-data"></form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


<script>
	
		$('#accordion').on('show.bs.collapse', function (element) {
		var id = '#' + element.target.id.replace('collapse','').toLowerCase() + 'Span';
		$(id).addClass("glyphicon-menu-down");
		});
		$('#accordion').on('hidden.bs.collapse', function (element) {
		var id = '#' + element.target.id.replace('collapse','').toLowerCase() + 'Span';
		$(id).removeClass("glyphicon-menu-down");
		});
		
		resolveRefs(dataModel, dataModel.$defs);
		
	var options = {
		operation: "CREATE",
		dataModel: this.dataModel
		};
	$('#plain').metadataeditorForm(options, (value) => {
		var resource = value;
		JSON.parse(JSON.stringify(resource));
		console.log(resource);
	});
	var options = {
		operation: "CREATE",
		dataModel: this.dataModel,
		uiForm: this.uiSchema,
		buttonTitle: "Submit"
	};
	$('#with-schema').metadataeditorForm(options, (value) => {
		var resource = value;
		JSON.parse(JSON.stringify(resource));
		console.log(resource);
	});
	var options = {
		operation: "READ",
		dataModel: this.dataModel,
		uiForm: this.uiSchema,
		resource: this.resource,
		buttonTitle: "OK"
	};
	$('#with-data').metadataeditorForm(options, () => {});
</script>
</body>
</html>